diff '--color=auto' --unified --recursive --text --color mujoco-2.1.3.orig/sample/testxml.cc mujoco-2.1.3.new/sample/testxml.cc
--- mujoco-2.1.3.orig/sample/testxml.cc	2022-03-23 23:59:24.771419662 -0400
+++ mujoco-2.1.3.new/sample/testxml.cc	2022-03-24 00:01:38.073551035 -0400
@@ -134,14 +134,13 @@
     return finish("Could not allocate mjData", m);
   }
 
-  // prepare temp filename in the same directory as original (for asset loading)
-  std::string tempfile;
-  std::size_t lastpath = filename.find_last_of("/\\");
-  if (lastpath==std::string::npos) {
-    tempfile = "_tempfile_.xml";
-  } else {
-    tempfile = filename.substr(0, lastpath+1) + "_tempfile_.xml";
+  // prepare a temporary file for asset loading
+  char tempdir_template[] = "/tmp/testxml_XXXXXX";
+  char* tempdir = mkdtemp(tempdir_template);
+  if ( !tempdir ) {
+    return finish("Could not create temporary directory", m, d);
   }
+  std::string tempfile = std::string(tempdir) + "/model.xml";
 
   // save
   if (!mj_saveLastXML(tempfile.c_str(), m, error, 1000)) {
@@ -164,6 +163,7 @@
   // delete temp model and file
   mj_deleteModel(mtemp);
   remove(tempfile.c_str());
+  remove(tempdir);
 
   // finalize
   return finish();
